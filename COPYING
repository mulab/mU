Copyright (c) 2007~2011 Xiang Zhang and contributors.